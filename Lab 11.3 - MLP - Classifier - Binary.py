# -*- coding: utf-8 -*-
"""OCDS - Lab 11.3 - MLP - Classifier - Binary.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1oAAd4jPFMFqBevbr163xhgP556Ostnyv

## MLP Classifier - Binary

**Import required libraries**
"""

import pandas as pd 
import seaborn as sns 
import matplotlib.pyplot as plt 
import numpy as np 
from sklearn.preprocessing import normalize 
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score, confusion_matrix, classification_report, precision_score, recall_score, f1_score
from sklearn.model_selection import RandomizedSearchCV

# Reading data 
import pandas as pd

from google.colab import files
file = files.upload()
import io
data = pd.read_csv(io.BytesIO(file['Churn_Modelling.csv']))

'''data = pd.read_csv('/content/Churn_Modelling.csv')
data.head()'''

data.head()

"""**Found 3617 zero balance values and it can be acceptable based on the type of the variable**"""

data['Balance'].isin([0]).sum()

data.shape

"""**Visualisation of the dataset**

The coding below shows the visualisation of the dataset in order to understand the data more. It can be seen that every species of the Iris can be segregated into different regions to be predicted.
"""

sns.lmplot(x = 'Age', y = 'EstimatedSalary', data=data, fit_reg=False, hue="Exited", scatter_kws={"marker": "D", "s": 50})
plt.title('Age vs EstimatedSalary')

sns.lmplot(x = 'Age', y = 'Balance', data=data, fit_reg=False, hue="Exited", scatter_kws={"marker": "D", "s": 50})
plt.title('Age vs EstimatedSalary')

sns.lmplot(x = 'Age', y = 'Tenure', data=data, fit_reg=False, hue="Exited", scatter_kws={"marker": "D", "s": 50})
plt.title('Age vs EstimatedSalary')

plt.show()

print(data["Exited"].value_counts())
sns.countplot(x = 'Exited', data = data)

"""**Coding TV**"""

data['Geography'] = pd.factorize(data['Geography'])[0]
data['Gender'] = pd.factorize(data['Gender'])[0]
data.head()

"""**Setting IV & TV**"""

X = data.iloc[:, 3:13].values
y = data.iloc[:, 13].values

y

"""**Normalization**"""

X = normalize(X, axis=0)
print("Examples of X Normalised\n", X[:3])

# Creating train,test and validation data
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 1)

print("Length of train set: ", X_train.shape, "y:", y_train.shape)
print("Length of test set: ", X_test.shape, "y:", y_test.shape)

"""### Neural network module

![image.png](data:image/png;base64,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)

**MLP Classifier**
"""

from sklearn.neural_network import MLPClassifier
from numpy import arange
mlp = MLPClassifier() 

mlp.fit(X_train,y_train)
y_pred = mlp.predict(X_test)
 
mlp_acc = accuracy_score(y_test, y_pred)
mlp_pre = precision_score(y_test, y_pred, average='micro')
mlp_recall = recall_score(y_test, y_pred, average='micro')
mlp_f1 = f1_score(y_test, y_pred, average='micro')
 
print("MLP - Accuracy: {:.3f}.".format(mlp_acc))
print("MLP - Precision: {:.3f}.".format(mlp_pre))
print("MLP - Recall: {:.3f}.".format(mlp_recall))
print("MLP - F1_Score: {:.3f}.".format(mlp_f1))
print("\nConfusion Matrix: \n", confusion_matrix(y_test, y_pred))
print ('\n Clasification Report:\n', classification_report(y_test,y_pred))

mlp.get_params()

"""**MLP Classifier - 3 HL (DNN)**"""

from sklearn.neural_network import MLPClassifier
from numpy import arange
mlp = MLPClassifier(hidden_layer_sizes=(300, 200, 100))

mlp.fit(X_train,y_train)
y_pred = mlp.predict(X_test)
 
mlp_acc = accuracy_score(y_test, y_pred)
mlp_pre = precision_score(y_test, y_pred, average='micro')
mlp_recall = recall_score(y_test, y_pred, average='micro')
mlp_f1 = f1_score(y_test, y_pred, average='micro')
 
print("MLP - Accuracy: {:.3f}.".format(mlp_acc))
print("MLP - Precision: {:.3f}.".format(mlp_pre))
print("MLP - Recall: {:.3f}.".format(mlp_recall))
print("MLP - F1_Score: {:.3f}.".format(mlp_f1))
print("\nConfusion Matrix: \n", confusion_matrix(y_test, y_pred))
print ('\n Clasification Report:\n', classification_report(y_test,y_pred))

"""**MLP CLassifier with Random Search CV**"""

from sklearn.neural_network import MLPClassifier
from numpy import arange
mlp = MLPClassifier(hidden_layer_sizes = (300, 200, 100))
 
parameters = {
    # 'hidden_layer_sizes': [(50,50,50), (50,100,50), (100,)],
    'activation': ['identity', 'logistic', 'tanh', 'relu'],
    'solver' : ['lbfgs', 'sgd', 'adam'],
    'learning_rate' : ['constant', 'invscaling', 'adaptive'],
    'random_state' : arange(0, 5, 1)
    }
 
mlp_r = RandomizedSearchCV(estimator = mlp, param_distributions = parameters, scoring = 'accuracy',
                              cv = 5, n_jobs = -1, verbose = 3, n_iter = 100)
mlp_r.fit(X_train, y_train)
best_parameters = mlp_r.best_params_  
best_score = mlp_r.best_score_ 
print(best_parameters)
print()
print(best_score)

best_model = mlp_r.best_estimator_

y_pred = best_model.predict(X_test)
 
# Get the accuracy score
mlp_r_acc = accuracy_score(y_test, y_pred)
mlp_r_pre = precision_score(y_test, y_pred, average='micro')
mlp_r_recall = recall_score(y_test, y_pred, average='micro')
mlp_r_f1 = f1_score(y_test, y_pred, average='micro')
 
print("MLP - Accuracy: {:.3f}.".format(mlp_r_acc))
print("MLP - Precision: {:.3f}.".format(mlp_r_pre))
print("MLP - Recall: {:.3f}.".format(mlp_r_recall))
print("MLP - F1_Score: {:.3f}.".format(mlp_r_f1))
print("\nConfusion Matrix: \n", confusion_matrix(y_test, y_pred))
print ('\n Clasification Report:\n', classification_report(y_test, y_pred))

"""Sklearn Tuner from Keras Tuner"""

pip install -q -U keras-tuner

from sklearn.neural_network import MLPClassifier
import keras_tuner as kt
from sklearn.model_selection import StratifiedKFold

def build_model(hp):
  model = MLPClassifier(hidden_layer_sizes = (300, 200, 100), max_iter = 10000,
      activation = hp.Choice('activation', ['identity', 'logistic', 'tanh', 'relu']),
      solver = hp.Choice('solver', ['lbfgs', 'sgd', 'adam']),
      learning_rate = hp.Choice('learning_rate', ['constant', 'invscaling', 'adaptive']),
      random_state = hp.Int('random_state', min_value = 0, max_value = 10, step = 1)
  )
  return model

tuner = kt.SklearnTuner(oracle = kt.oracles.BayesianOptimizationOracle(objective = kt.Objective('score', 'max'),
        max_trials = 3), hypermodel = build_model, cv = StratifiedKFold(5), overwrite = True)

tuner.search(X_train, y_train)

print()
best_model = tuner.get_best_models(num_models=1)[0]
best_model

best_model